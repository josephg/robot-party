@robot 'federatron'

io = require 'socket.io-client'

@listen 'federate', ({data:host, local}, reply) =>
	return unless local

	socket = io.connect host

	socket.on 'error', (e) -> console.log 'federatron', e

	socket.on 'connect', ->
		reply 'federated'
		socket.json.send {type:'I federated to you guys'}

	socket.on 'message', (msg) => @sendRaw msg unless msg.local
	@listen (msg) -> socket.json.send msg unless msg.local
