@robot "nix"
  local: true

user = undefined

setUser = (name) =>
  olduser = user
  user = name
  @transmit type:"user nickname", user:olduser, data:user
  @transmit type:"user nickname", user:olduser, data:user, local:true

@transmit {type:'name me', local:false}, ({data}) -> setUser data

@listen 'usercmd', ({data:cmd}, reply) ->
  if match = cmd.match /nick\s+(.*)$/
    setUser match[1]

