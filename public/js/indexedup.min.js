(function(){var e=function(r,t){var n=e.resolve(r,t||"/"),o=e.modules[n];if(!o)throw Error("Failed to resolve module "+r+", tried "+n);var i=e.cache[n],s=i?i.exports:o();return s};e.paths=[],e.modules={},e.cache={},e.extensions=[".js",".coffee",".json"],e._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},e.resolve=function(){return function(r,t){function n(r){if(r=c.normalize(r),e.modules[r])return r;for(var t=0;e.extensions.length>t;t++){var n=e.extensions[t];if(e.modules[r+n])return r+n}}function o(r){r=r.replace(/\/+$/,"");var t=c.normalize(r+"/package.json");if(e.modules[t]){var o=e.modules[t](),i=o.browserify;if("object"==typeof i&&i.main){var s=n(c.resolve(r,i.main));if(s)return s}else if("string"==typeof i){var s=n(c.resolve(r,i));if(s)return s}else if(o.main){var s=n(c.resolve(r,o.main));if(s)return s}}return n(r+"/index")}function i(e,r){for(var t=s(r),i=0;t.length>i;i++){var c=t[i],a=n(c+"/"+e);if(a)return a;var u=o(c+"/"+e);if(u)return u}var a=n(e);return a?a:void 0}function s(e){var r;r="/"===e?[""]:c.normalize(e).split("/");for(var t=[],n=r.length-1;n>=0;n--)if("node_modules"!==r[n]){var o=r.slice(0,n+1).join("/")+"/node_modules";t.push(o)}return t}if(t||(t="/"),e._core[r])return r;var c=e.modules.path();t=c.resolve("/",t);var a=t||"/";if(r.match(/^(?:\.\.?\/|\/)/)){var u=n(c.resolve(a,r))||o(c.resolve(a,r));if(u)return u}var d=i(r,a);if(d)return d;throw Error("Cannot find module '"+r+"'")}}(),e.alias=function(r,t){var n=e.modules.path(),o=null;try{o=e.resolve(r+"/package.json","/")}catch(i){o=e.resolve(r,"/")}for(var s=n.dirname(o),c=(Object.keys||function(e){var r=[];for(var t in e)r.push(t);return r})(e.modules),a=0;c.length>a;a++){var u=c[a];if(u.slice(0,s.length+1)===s+"/"){var d=u.slice(s.length);e.modules[t+d]=e.modules[s+d]}else u===s&&(e.modules[t]=e.modules[s])}},function(){var r={},t="undefined"!=typeof window?window:{},n=!1;e.define=function(o,i){!n&&e.modules.__browserify_process&&(r=e.modules.__browserify_process(),n=!0);var s=e._core[o]?"":e.modules.path().dirname(o),c=function(r){var t=e(r,s),n=e.cache[e.resolve(r,s)];return n&&null===n.parent&&(n.parent=a),t};c.resolve=function(r){return e.resolve(r,s)},c.modules=e.modules,c.define=e.define,c.cache=e.cache;var a={id:o,filename:o,exports:{},loaded:!1,parent:null};e.modules[o]=function(){return e.cache[o]=a,i.call(a.exports,c,a,a.exports,s,o,r,t),a.loaded=!0,a.exports}}}(),e.define("path",function(e,r,t,n,o,i){function s(e,r){for(var t=[],n=0;e.length>n;n++)r(e[n],n,e)&&t.push(e[n]);return t}function c(e,r){for(var t=0,n=e.length;n>=0;n--){var o=e[n];"."==o?e.splice(n,1):".."===o?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t--;t)e.unshift("..");return e}var a=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;t.resolve=function(){for(var e="",r=!1,t=arguments.length;t>=-1&&!r;t--){var n=t>=0?arguments[t]:i.cwd();"string"==typeof n&&n&&(e=n+"/"+e,r="/"===n.charAt(0))}return e=c(s(e.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+e||"."},t.normalize=function(e){var r="/"===e.charAt(0),t="/"===e.slice(-1);return e=c(s(e.split("/"),function(e){return!!e}),!r).join("/"),e||r||(e="."),e&&t&&(e+="/"),(r?"/":"")+e},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(s(e,function(e){return e&&"string"==typeof e}).join("/"))},t.dirname=function(e){var r=a.exec(e)[1]||"",t=!1;return r?1===r.length||t&&3>=r.length&&":"===r.charAt(1)?r:r.substring(0,r.length-1):"."},t.basename=function(e,r){var t=a.exec(e)[2]||"";return r&&t.substr(-1*r.length)===r&&(t=t.substr(0,t.length-r.length)),t},t.extname=function(e){return a.exec(e)[3]||""}}),e.define("__browserify_process",function(e,r,t,n,o,i){var i=r.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,r="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(r){var t=[];return window.addEventListener("message",function(e){if(e.source===window&&"browserify-tick"===e.data&&(e.stopPropagation(),t.length>0)){var r=t.shift();r()}},!0),function(e){t.push(e),window.postMessage("browserify-tick","*")}}return function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.binding=function(r){if("evals"===r)return e("vm");throw Error("No such module. (Possibly not yet loaded)")},function(){var r,t="/";i.cwd=function(){return t},i.chdir=function(n){r||(r=e("path")),t=r.resolve(n,t)}}()}),e.define("stream",function(e,r){function t(){n.EventEmitter.call(this)}var n=e("events"),o=e("util");o.inherits(t,n.EventEmitter),r.exports=t,t.Stream=t,t.prototype.pipe=function(e,r){function t(r){e.writable&&!1===e.write(r)&&a.pause&&a.pause()}function n(){a.readable&&a.resume&&a.resume()}function o(){u||(u=!0,e._pipeCount--,c(),e._pipeCount>0||e.end())}function i(){u||(u=!0,e._pipeCount--,c(),e._pipeCount>0||e.destroy())}function s(e){if(c(),0===this.listeners("error").length)throw e}function c(){a.removeListener("data",t),e.removeListener("drain",n),a.removeListener("end",o),a.removeListener("close",i),a.removeListener("error",s),e.removeListener("error",s),a.removeListener("end",c),a.removeListener("close",c),e.removeListener("end",c),e.removeListener("close",c)}var a=this;a.on("data",t),e.on("drain",n),e._isStdio||r&&r.end===!1||(e._pipeCount=e._pipeCount||0,e._pipeCount++,a.on("end",o),a.on("close",i));var u=!1;return a.on("error",s),e.on("error",s),a.on("end",c),a.on("close",c),e.on("end",c),e.on("close",c),e.emit("pipe",a),e}}),e.define("events",function(e,r,t,n,o,i){i.EventEmitter||(i.EventEmitter=function(){});var s=t.EventEmitter=i.EventEmitter,c="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=10;s.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},s.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||c(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var r=this._events[e];if(!r)return!1;if("function"==typeof r){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:var t=Array.prototype.slice.call(arguments,1);r.apply(this,t)}return!0}if(c(r)){for(var t=Array.prototype.slice.call(arguments,1),n=r.slice(),o=0,i=n.length;i>o;o++)n[o].apply(this,t);return!0}return!1},s.prototype.addListener=function(e,r){if("function"!=typeof r)throw Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",e,r),this._events[e])if(c(this._events[e])){if(!this._events[e].warned){var t;t=void 0!==this._events.maxListeners?this._events.maxListeners:a,t&&t>0&&this._events[e].length>t&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}this._events[e].push(r)}else this._events[e]=[this._events[e],r];else this._events[e]=r;return this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(e,r){var t=this;return t.on(e,function n(){t.removeListener(e,n),r.apply(this,arguments)}),this},s.prototype.removeListener=function(e,r){if("function"!=typeof r)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var t=this._events[e];if(c(t)){var n=t.indexOf(r);if(0>n)return this;t.splice(n,1),0==t.length&&delete this._events[e]}else this._events[e]===r&&delete this._events[e];return this},s.prototype.removeAllListeners=function(e){return e&&this._events&&this._events[e]&&(this._events[e]=null),this},s.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),c(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}),e.define("util",function(e,r,t){function n(e){return e instanceof Array||Array.isArray(e)||e&&e!==Object.prototype&&n(e.__proto__)}function o(e){return e instanceof RegExp||"object"==typeof e&&"[object RegExp]"===Object.prototype.toString.call(e)}function i(e){if(e instanceof Date)return!0;if("object"!=typeof e)return!1;var r=Date.prototype&&c(Date.prototype),t=e.__proto__&&c(e.__proto__);return JSON.stringify(t)===JSON.stringify(r)}e("events"),t.print=function(){},t.puts=function(){},t.debug=function(){},t.inspect=function(e,r,a,u){function d(e,a){if(e&&"function"==typeof e.inspect&&e!==t&&(!e.constructor||e.constructor.prototype!==e))return e.inspect(a);switch(typeof e){case"undefined":return p("undefined","undefined");case"string":var u="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return p(u,"string");case"number":return p(""+e,"number");case"boolean":return p(""+e,"boolean")}if(null===e)return p("null","null");var f=s(e),h=r?c(e):f;if("function"==typeof e&&0===h.length){if(o(e))return p(""+e,"regexp");var E=e.name?": "+e.name:"";return p("[Function"+E+"]","special")}if(i(e)&&0===h.length)return p(e.toUTCString(),"date");var v,m,y;if(n(e)?(m="Array",y=["[","]"]):(m="Object",y=["{","}"]),"function"==typeof e){var g=e.name?": "+e.name:"";v=o(e)?" "+e:" [Function"+g+"]"}else v="";if(i(e)&&(v=" "+e.toUTCString()),0===h.length)return y[0]+v+y[1];if(0>a)return o(e)?p(""+e,"regexp"):p("[Object]","special");l.push(e);var w=h.map(function(r){var t,o;if(e.__lookupGetter__&&(e.__lookupGetter__(r)?o=e.__lookupSetter__(r)?p("[Getter/Setter]","special"):p("[Getter]","special"):e.__lookupSetter__(r)&&(o=p("[Setter]","special"))),0>f.indexOf(r)&&(t="["+r+"]"),o||(0>l.indexOf(e[r])?(o=null===a?d(e[r]):d(e[r],a-1),o.indexOf("\n")>-1&&(o=n(e)?o.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+o.split("\n").map(function(e){return"   "+e}).join("\n"))):o=p("[Circular]","special")),t===void 0){if("Array"===m&&r.match(/^\d+$/))return o;t=JSON.stringify(""+r),t.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(t=t.substr(1,t.length-2),t=p(t,"name")):(t=t.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t=p(t,"string"))}return t+": "+o});l.pop();var O=0,_=w.reduce(function(e,r){return O++,r.indexOf("\n")>=0&&O++,e+r.length+1},0);return w=_>50?y[0]+(""===v?"":v+"\n ")+" "+w.join(",\n  ")+" "+y[1]:y[0]+v+" "+w.join(", ")+" "+y[1]}var l=[],p=function(e,r){var t={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[r];return n?"["+t[n][0]+"m"+e+"["+t[n][1]+"m":e};return u||(p=function(e){return e}),d(e,a===void 0?2:a)},t.log=function(){},t.pump=null;var s=Object.keys||function(e){var r=[];for(var t in e)r.push(t);return r},c=Object.getOwnPropertyNames||function(e){var r=[];for(var t in e)Object.hasOwnProperty.call(e,t)&&r.push(t);return r},a=Object.create||function(e,r){var t;if(null===e)t={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var n=function(){};n.prototype=e,t=new n,t.__proto__=e}return r!==void 0&&Object.defineProperties&&Object.defineProperties(t,r),t};t.inherits=function(e,r){e.super_=r,e.prototype=a(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})};var u=/%[sdj%]/g;t.format=function(e){if("string"!=typeof e){for(var r=[],n=0;arguments.length>n;n++)r.push(t.inspect(arguments[n]));return r.join(" ")}for(var n=1,o=arguments,i=o.length,s=(e+"").replace(u,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return o[n++]+"";case"%d":return Number(o[n++]);case"%j":return JSON.stringify(o[n++]);default:return e}}),c=o[n];i>n;c=o[++n])s+=null===c||"object"!=typeof c?" "+c:" "+t.inspect(c);return s}}),e.define("/src/errors.js",function(e,r){var t=e("errno"),n=t.custom.createError("LevelUPError");r.exports={LevelUPError:n,InitializationError:t.custom.createError("InitializationError",n),OpenError:t.custom.createError("OpenError",n),ReadError:t.custom.createError("ReadError",n),WriteError:t.custom.createError("WriteError",n),NotFoundError:t.custom.createError("NotFoundError",n),CloseError:t.custom.createError("CloseError",n)}}),e.define("/node_modules/errno/package.json",function(e,r){r.exports={main:"errno.js"}}),e.define("/node_modules/errno/errno.js",function(e,r){var t=r.exports.all=[{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"no more processes"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:""},{errno:7,code:"EAFNOSUPPORT",description:""},{errno:8,code:"EALREADY",description:""},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:""},{errno:42,code:"EAIFAMNOSUPPORT",description:""},{errno:44,code:"EAISERVICE",description:""},{errno:45,code:"EAISOCKTYPE",description:""},{errno:46,code:"ESHUTDOWN",description:""},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];r.exports.errno={"-1":t[0],0:t[1],1:t[2],2:t[3],3:t[4],4:t[5],5:t[6],6:t[7],7:t[8],8:t[9],9:t[10],10:t[11],11:t[12],12:t[13],13:t[14],14:t[15],15:t[16],16:t[17],17:t[18],18:t[19],19:t[20],20:t[21],21:t[22],22:t[23],23:t[24],24:t[25],25:t[26],26:t[27],27:t[28],28:t[29],29:t[30],31:t[31],32:t[32],33:t[33],34:t[34],35:t[35],36:t[36],37:t[37],38:t[38],39:t[39],40:t[40],41:t[41],42:t[42],44:t[43],45:t[44],46:t[45],47:t[46],48:t[47],49:t[48],50:t[49],51:t[50],52:t[51],53:t[52],54:t[53],55:t[54],56:t[55],57:t[56],58:t[57],59:t[58]},r.exports.code={UNKNOWN:t[0],OK:t[1],EOF:t[2],EADDRINFO:t[3],EACCES:t[4],EAGAIN:t[5],EADDRINUSE:t[6],EADDRNOTAVAIL:t[7],EAFNOSUPPORT:t[8],EALREADY:t[9],EBADF:t[10],EBUSY:t[11],ECONNABORTED:t[12],ECONNREFUSED:t[13],ECONNRESET:t[14],EDESTADDRREQ:t[15],EFAULT:t[16],EHOSTUNREACH:t[17],EINTR:t[18],EINVAL:t[19],EISCONN:t[20],EMFILE:t[21],EMSGSIZE:t[22],ENETDOWN:t[23],ENETUNREACH:t[24],ENFILE:t[25],ENOBUFS:t[26],ENOMEM:t[27],ENOTDIR:t[28],EISDIR:t[29],ENONET:t[30],ENOTCONN:t[31],ENOTSOCK:t[32],ENOTSUP:t[33],ENOENT:t[34],ENOSYS:t[35],EPIPE:t[36],EPROTO:t[37],EPROTONOSUPPORT:t[38],EPROTOTYPE:t[39],ETIMEDOUT:t[40],ECHARSET:t[41],EAIFAMNOSUPPORT:t[42],EAISERVICE:t[43],EAISOCKTYPE:t[44],ESHUTDOWN:t[45],EEXIST:t[46],ESRCH:t[47],ENAMETOOLONG:t[48],EPERM:t[49],ELOOP:t[50],EXDEV:t[51],ENOTEMPTY:t[52],ENOSPC:t[53],EIO:t[54],EROFS:t[55],ENODEV:t[56],ESPIPE:t[57],ECANCELED:t[58]},r.exports.custom=e("./custom")(r.exports)}),e.define("/node_modules/errno/custom.js",function(e,r){function t(e,r,t){this.name=e,this.cause="string"!=typeof r?r:t,this.message=r&&"string"!=typeof r?r.message:r}function n(e,r){Error.call(this),Error.captureStackTrace(this,arguments.callee),t.call(this,"CustomError",e,r)}function o(e,r,o){var i=function(n,o){t.call(this,r,n,o),"FilesystemError"==r&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(e.errno[this.cause.errno]?e.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace(this,arguments.callee)};return i.prototype=o?new o:new n,i}n.prototype=Error(),r.exports=function(e){var r=o.bind(null,e);return{CustomError:n,FilesystemError:r("FilesystemError"),createError:r}}}),e.define("/src/utils.js",function(e,r){function t(e,r){return"json"===r?JSON.stringify(e):e}function n(e,r){return"json"===r?JSON.parse(""+e):e}function o(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}function i(e,r){function t(){this.constructor=e}return o(e,r),t.prototype=r.prototype,e.prototype=new t,e.__super__=r.prototype,e}function s(e,r){if(r)return r(e);throw e}r.exports={encode:t,decode:n,extend:o,inherits:i,handleError:s}}),e.define("/src/indexedup.js",function(e,r,t,n,o,i){function s(e,r){if(null==r&&(r={}),"string"!=typeof e){var t=new l.InitializationError("Must provide a location for the database");return p.handleError(t)}this._options=p.extend({createIfMissing:!1,errorIfExists:!1,encoding:"utf8",sync:!1},r),this._storename="indexedup",this._location=e,this._status="new"}function c(e,r){this.idb=e,this.readable=!0,i.nextTick(this.init.bind(this)),this._options=p.extend({start:null,end:null,reverse:!1,keys:!0,values:!0,limit:-1},r)}function a(e){this.idb=e,this.writable=!0,this.buffer=[],this._end=!1,this.scheduled=!1,this.flushWrites=this.flushWrites.bind(this)}function u(e,r,t){"function"==typeof r&&(t=r,r=null);var n=new s(e,r);return n.open(t)}var d=e("stream"),l=e("./errors"),p=e("./utils"),f=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.oIndexedDB;window.IDBTransaction||window.mozIDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction||window.oIndexedDB;var h=window.IDBKeyRange||window.mozIDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange||window.oIDBKeyRange;s.prototype.open=function(e){function r(){var e=null;try{e=t.getStore(!0)}catch(r){}if(!o)return t._options.errorIfExists&&null!=e?new l.OpenError("Database already exists (errorIfExists: true)"):t._options.createIfMissing||e?(o=!0,!1):new l.OpenError("Database doesn't exist (createIfMissing: false)")}var t=this,n=f.open(this._location),o=!1;n.onsuccess=function(){t.db=n.result,t._status="open";var o;return(o=r())?p.handleError(o,e):("function"==typeof e&&e(null,t),void 0)},n.onupgradeneeded=function(n){var o;if(o=r())return p.handleError(o,e);var i=n.target.result;t.store=i.createObjectStore(t._storename,{keyPath:"key"})},n.onerror=function(r){var t=new l.OpenError(r);return p.handleError(t,e)}},s.prototype.close=function(e){if(this.isOpen())return this.db=null,this._status="closed",e();var r=new l.CloseError("Cannot close unopened database");return p.handleError(r,e)},s.prototype.isOpen=function(){return"open"===this._status},s.prototype.isClosed=function(){return"closed"===this._status},s.prototype.getTransaction=function(e){var r=e?"readwrite":"readonly";return this.db.transaction([this._storename],r)},s.prototype.getStore=function(e,r){return null==r&&(r=this.getTransaction(e)),r.objectStore(this._storename)},s.prototype.put=function(e,r,t,n){if("function"==typeof t&&(n=t,t=null),!this.isOpen()){var o=new l.WriteError("Database has not been opened");return p.handleError(o,n)}if(null==e){var o=new l.WriteError("Invalid key");return p.handleError(o,n)}if(null==r){var o=new l.WriteError("Invalid data");return p.handleError(o,n)}var i=this.getStore(!0).put({key:e,value:r});i.onsuccess=function(){return"function"==typeof n?n(null,i.result):void 0},i.onerror=function(e){return o=new l.WriteError(e),p.handleError(o,n)}},s.prototype.get=function(e,r,t){if("function"==typeof r&&(t=r,r=t),!this.isOpen()){var n=new l.ReadError("Database has not been opened");return p.handleError(n,t)}if(null==e){var n=new l.ReadError("Invalid key");return p.handleError(n,t)}var o=this.getStore().get(e);o.onsuccess=function(){o.result,o.result!==void 0&&"function"==typeof t?t(null,o.result.value):o.onerror()},o.onerror=function(r){var r=new l.NotFoundError("Key not found in database ["+e+"]");return p.handleError(r,t)}},s.prototype.del=function(e,r,t){if("function"==typeof r&&(t=r,r=t),!this.isOpen()){var n=new l.WriteError("Database has not been opened");return p.handleError(n,t)}if(null==e){var n=new l.WriteError("Invalid key");return p.handleError(n,t)}var o=this.getStore(!0)["delete"](e);o.onsuccess=function(){"function"==typeof t&&t(null,o.result)},o.onerror=function(e){var r=new l.WriteError(e);if("function"==typeof t)return t(r);throw r}},s.prototype.batch=function(e,r){if(!this.isOpen()){var t=new l.WriteError("Database has not been opened");return p.handleError(t,r)}for(var n=this.getTransaction(!0),o=this.getStore(null,n),i=0,s=e.length;s>i;i++){var c=e[i];if(null!=c.type&&null!=c.key)switch(c.type){case"put":o.put({key:c.key,value:c.value});break;case"del":o["delete"](c.key)}}n.oncomplete=function(){"function"==typeof r&&r()},n.onerror=function(e){var t=new l.WriteError(e);return p.handleError(t,r)}},p.inherits(c,d.Stream),c.prototype.init=function(e){var r=this,t=this.idb.getTransaction(),n=this.idb.getStore(t),o=h.lowerBound(0),i=n.openCursor(o),e=this._options;i.onsuccess=function(t){var n=t.target.result,o=null;return n?(e.keys&&e.values?o=n.value:e.keys&&!e.values?o=n.value.key:e.values&&(o=n.value.value),r.emit("data",o),n["continue"](),void 0):(r.end(),void 0)},i.onerror=function(e){r.emit("error",e)}},c.prototype.end=function(){this.emit("end")},p.inherits(a,d.Stream),a.prototype.write=function(e){return this.writable?(0===this.buffer.length&&(i.nextTick(this.flushWrites),this.scheduled=!0),this.buffer.push(e),!0):!1},a.prototype.flushWrites=function(){if(this.scheduled=!1,this.writable){var e=this;if(1===this.buffer.length){var r=this.buffer.shift();this.idb.put(r.key,r.value,function(r){r&&e.emit("error",r)})}else this.buffer.length>1&&(this.buffer.map(function(e){e.type="put"}),this.idb.batch(this.buffer,function(r){r&&e.emit("error",r)}));this._end&&(this.writable=!1,this.emit("close"))}},a.prototype.destroy=function(){this.writable=!1,this.end()},a.prototype.end=function(){this._end=!0,this.scheduled||i.nextTick(this.flushWrites)},s.prototype.readStream=function(){return new c(this)},s.prototype.keyStream=function(){return new c(this,{keys:!0,values:!1})},s.prototype.valueStream=function(){return new c(this,{keys:!1,values:!0})},s.prototype.writeStream=function(){return new a(this)},r!==void 0&&r.exports&&(r.exports=u),"undefined"!=typeof window&&(window.indexedup=u)}),e("/src/indexedup.js")})();