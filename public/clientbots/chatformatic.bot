@robot 'chatformatic'

@defaults.local = true

escapeHTML = (html) -> $('<div/>').text(html).html() if html?

@transmit "handling type", "chat"

@listen "chat", ({user, data: msg}) ->
  message = "<div class='source'>#{user || "anonymous"}</div><div class='text'>#{escapeHTML msg}</div>"
  @transmit "display message", message, {user}